name: Jalankan Python yt-m3u8

on:
  workflow_dispatch:
  schedule:
    - cron: '4 * * * *'  # Setiap 1 jam penuh (00:00, 01:00, dst)

jobs:
  run:
    runs-on: ubuntu-latest

    steps:
      # 1. Checkout repo publik
      - name: Checkout Repo Publik
        uses: actions/checkout@v4

      # 2. Install dependensi
      - name: Install yt-dlp dan Python package
        run: |
          sudo apt-get update
          sudo apt-get install -y jq
          pip install -U yt-dlp

      # 3. Clone repo privat (cookies + urls.txt)
      - name: Ambil cookies dan URL dari repo privat
        run: |
          git clone https://x-access-token:${{ secrets.TOKEN_PRIVATE }}@github.com/${{ secrets.REPO_PRIVATE }} private
          cp private/cookies.txt $HOME/cookies.txt
          cp private/urls.txt $HOME/urls.txt

      # 4. Jalankan skrip Python
      - name: Jalankan bash1.py
        run: |
          python bash1.py

      # 5. Push hasil update (sudah ditangani di dalam Python)
